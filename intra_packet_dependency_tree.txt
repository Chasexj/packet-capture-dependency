Intra Packet Header Field Value Calculation Dependency
└── IPV4 Header
    ├── Version (4 bits)
    ├── Internet Header Length (IHL, 4 bits: Used to specify how many 4 byte words the header contains, with a minimum of 5 words (20 bytes) and a maximum of 15 words (60 bytes)) | Calculation = decimal-to-binary((number of present IPV4 header bits (typically 160 bits) + number of present IP option bits) / 8 bits-per-byte)/ 4 bytes-per-word); If IP options bits = none, set min to 0101 or 4 words or 20 bytes)
    │   ├── Total Length (16 bits: Used to specify the number of bytes for total packet length, with a minimum of 20 bytes and a maximum of 65535 bytes) | Calculation =  decimal-to-binary(TCP/ICMP/UDP header size in bytes (e.g, Data offset in TCP) + IHL in bytes + TCP/ICMP/UDP payload size (if present) in bytes); Must be greater or equal to than TCP/ICMP/UDP header size in bytes + IHL in bytes
    │   ├── Data (variable length in bytes, depends on Total Length and IHL: Total Length (bytes) - IHL*4(bytes/word))
    │   │   ├── TCP Header (variable length, depends on Data Offset field)
    │   │   │   ├── Source Port (16 bits)
    │   │   │   ├── Destination Port (16 bits)
    │   │   │   ├── Sequence Number (32 bits)
    │   │   │   ├── Acknowledgment Number (32 bits)
    │   │   │   ├── Data Offset (4 bits: Used to specify the size of the TCP header in 32-bit (or 4 byte) words, with a minimum of 5 words (20 bytes) and a maximum of 15 words (60 bytes)) | Calculation = decimal-to-binary((number of present TCP header bits (typically 160 bits) + number of present TCP option bits) / 8 bits-per-byte)/ 4 bytes-per-word); If TCP options bits = none, set min to 0101 or 4 words or 20 bytes)
    │   │   │   ├── Reserved (3 bits)
    │   │   │   ├── Flags (9 bits)
    │   │   │   ├── Window Size (16 bits)
    │   │   │   ├── Checksum (16 bits)
    │   │   │   ├── Urgent Pointer (16 bits)
    │   │   │   └── Options (Variable size: (Data Offset-5)*4 bytes if Data Offset > 5, i.e., 5 words = 20 bytes = min TCP header size; in nprint representation, it has 320 bits binary representation since option can have a maximum size of 40 bytes (60 -20), using -1 to denote missing ones)
    │   │   ├── TCP Payload (variable length: Total Length (bytes) - IHL*4 (bytes/word) - Data Offset*4 bytes)
    │   │   ├── UDP Header (8 bytes)
    │   │   │   ├── Source Port (16 bits)
    │   │   │   ├── Destination Port (16 bits)
    │   │   │   ├── Length (16 bits: Used to specify the number of bytes in the UDP header and UDP data, with a minimum of 8 bytes and a maximum of 65535 bytes - IHL - UDP Header Length (8 bytes))
    │   │   │   └── Checksum (16 bits)
    │   │   ├── UDP Payload (variable length: Total Length - IHL*4 (bytes/word) - UDP Header Length (8 bytes))
    │   │   ├── ICMP Header (8 bytes)
    │   │   │   ├── Type (8 bits)
    │   │   │   ├── Code (8 bits)
    │   │   │   ├── Checksum (16 bits)
    │   │   │   └── Rest of Header (variable based on Type and Code)
    │   │   │       ├── If Type is 0 or 8 (Echo Reply or Request)
    │   │   │       │   ├── Identifier (16 bits)
    │   │   │       │   └── Sequence Number (16 bits)
    │   │   │       ├── If Type is 3 (Destination Unreachable)
    │   │   │       │   ├── Unused (Most significant 24 bits)
    │   │   │       │   ├── Next-Hop MTU (Least significant 8 bits, only for Code 4)
    │   │   │       │   └── Original IP Header + First 64 bits of original datagram
    │   │   │       └── ... other types omitted for brevity
    │   │   └── ICMP Payload (variable length: Total Length - IHL*4 - ICMP Header length)
    │   └── Options (Variable size: (IHL-5)*4 bytes, if IHL > 5; in nprint representation, it has 320 bits binary representation since option can have a maximum size of 40 bytes (60 -20), using -1 to denote missing ones)
    ├── Differentiated Services Code Point/Type of Service (8 bits)
    ├── Identification (16 bits)
    ├── Flags (3 bits)
    ├── Fragment Offset (13 bits)
    ├── Time to Live (8 bits)
    ├── Protocol (8 bits)
    │   └── Data (variable length, it's interpretation depends on Protocol)
    ├── Header Checksum (16 bits)
    ├── Source IP Address (32 bits)
    ├── Destination IP Address (32 bits)
    └── others
